#!/usr/bin/env bash

set -e

DOCKERFILE_NAME="Dockerfile.malwareanalysis"

IMAGE_NAME="malware-analysis"

if docker inspect $IMAGE_NAME > /dev/null 2>&1; then
    CONTAINER_IDS=$(docker ps -a -q --filter ancestor=$IMAGE_NAME)

    if [ -n "$CONTAINER_IDS" ]; then
        docker rm -f $CONTAINER_IDS
    fi

    docker rmi $IMAGE_NAME
fi

docker build -t $IMAGE_NAME -f $DOCKERFILE_NAME .

docker run -p 7055:7055 $IMAGE_NAME
